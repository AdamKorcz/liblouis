table: |
  display , 6
  display # 3456
  display ; 56
  display - 36
  punctuation - 36
  include tables/latinLetterDef6Dots.uti
  include tables/digits6Dots.uti
  include tables/litdigits6Dots.uti
  include tables/braille-patterns.cti
  capsletter 6
  numsign 3456
  nocontractsign 56
  numericnocontchars abcdefghij
  numericmodechars -

# First check if forward translation reflects expected backward translation
# possibly to be removed or compressed when issue has been fixed.
tests:
  # Characters is in numericnocontchars require nocontractsign to cancel numeric mode
  - - "123abc"
    - "#abc;abc"
  # "k" is not in numericnocontchars so does not require contractsign to cancel numeric mode
  - - "123kabc"
    - "#abckabc"
  # whitespace cancels numeric mode
  - - "123 abc"
    - "#abc abc"
  # capsletter cancels numeric mode
  - - "123Abc"
    - "#abc,abc"
  - - "123Kabc"
    - "#abc,kabc"

  # FIXME: the following tests are only relevant if capsletter fails to cancel numeric mode
  # once stuck, numeric mode may not be canceled even by nocontractsign
  - - "123Abckabc" # FIXME: undefined behavior?
    - "#abc,abckabc"
    # Reasonable forward translation

  - - "123Abcabc" # FIXME: undefined behavior?
    - "#abc,abcabc"

  # ... but it may be canceled by a numcontractsign if it directly follows a numericnocontchar
  - - "123Abc1abc"
    - "#abc,abc#a;abc"
  - - "123Abcabc" # FIXME: undefined behavior?
    - "#abc,abcabc"

  # ... it may also be canceled by whitespace
  - - "123Abc abc"
    - "#abc,abc abc"

  # numericmodechars do not cancel numeric mode
  - - "123-123"
    - "#abc-abc"
  - - "123-abc"
    - "#abc-;abc"
  - - "123-Abc"
    - "#abc-,abc"

# Original tests - the actual issue
flags: {testmode: backward}
tests:
  # Characters is in numericnocontchars require nocontractsign to cancel numeric mode
  - - "#abc;abc"
    - "123abc"
  # "s" is not in numericnocontchars so does not require contractsign to cancel numeric mode
  - - "#abckabc"
    - "123kabc"
  # whitespace cancels numeric mode
  - - "#abc abc"
    - "123 abc"
  # capsletter cancels numeric mode
  - - "#abc,abc"
    - "123Abc"
  - - "#abc,kabc"
    - "123Kabc"

  # FIXME: the following tests are only relevant if capsletter fails to cancel numeric mode
  # once stuck, numeric mode may not be canceled even by nocontractsign
  - - "#abc,abck;abc"
    - "123Abckabc" # FIXME: undefined behavior?
    - {xfail: true}
    # Received: '123Abck\56/abc'
    # Buevest: Nocontractsign should be ignored if it has no effect.

  - - "#abc,abc#;abc"
    - "123Abcabc" # FIXME: undefined behavior?
    - {xfail: true}
    # Buevest: Should also work.
    # nocontractsign or letsign should cancel numeric mode no matter what.

  # ... but it may be canceled by a numcontractsign if it directly follows a numericnocontchar
  - - "#abc,abc#a;abc"
    - "123Abc1abc"
  - - "#abc,abc;abc"
    - "123Abcabc" # FIXME: undefined behavior?
    - {xfail: true} # capsletter fails, numcontractsign works
  # ... it may also be canceled by whitespace
  - - "#abc,abc abc"
    - "123Abc abc"

  # numericmodechars do not cancel numeric mode
  - - "#abc-abc"
    - "123-123"
  - - "#abc-;abc"
    - "123-abc"
  - - "#abc-,abc"
    - "123-Abc"

### begcapsword and endcapsword

table: |
  display , 456
  display # 3456
  display ; 56
  display . 5
  display - 36
  sign % 123456
  punctuation - 36
  include tables/latinLetterDef6Dots.uti
  include tables/digits6Dots.uti
  include tables/litdigits6Dots.uti
  include tables/braille-patterns.cti
  numsign 3456
  nocontractsign 56
  numericnocontchars abcdefghij
  begcapsword 456
  endcapsword 5
  capsmodechars -

# First check if forward translation reflects expected backward translation
# possibly to be removed or compressed when issue has been fixed.
tests:
  # endcapsword cancels a word in capitals
  - - "ABCabc"
    - ",abc.abc"
  # Whitespace cancels a word in capitals
  - - "ABC abc"
    - ",abc abc"
  # Non-letter cancels a word in capitals
  - - "ABC%abc"
    - ",abc%abc"
  # Number cancels a word in capitals
  - - "ABC123abc"
    - ",abc#abc;abc"
  # capsmodechars do not cancel a capsword
  - - "ABC-abc"
    - ",abc-.abc"
  - - "ABC-ABC"
    - ",abc-abc"

# Original tests
flags: {testmode: backward}
tests:
  # endcapsword cancels a word in capitals
  - - ",abc.abc"
    - "ABCabc"
  # Whitespace cancels a word in capitals
  - - ",abc abc"
    - "ABC abc"
  # Non-letter cancels a word in capitals
  - - ",abc%abc"
    - "ABC%abc"
    - {xfail: true}
  # Number cancels a word in capitals
  - - ",abc#abc;abc"
    - "ABC123abc"
  # capsmodechars do not cancel a capsword
  - - ",abc-.abc"
    - "ABC-abc"
  - - ",abc-abc."
    - "ABC-ABC"
    # Probably a "false pass"..

### begcaps and endcaps

table: |
  display , 456
  display # 3456
  display ; 56
  display . 5
  display - 36
  sign % 123456
  punctuation - 36
  include tables/latinLetterDef6Dots.uti
  include tables/digits6Dots.uti
  include tables/litdigits6Dots.uti
  include tables/braille-patterns.cti
  numsign 3456
  nocontractsign 56
  numericnocontchars abcdefghij
  begcaps 456
  endcaps 5
  capsmodechars -

# Forward tests (see above)
tests:
  # endcaps cancels a block in capitals
  - - "ABCabc"
    - ",abc.abc"
  # Whitespace does not cancel a block in capitals
  - - "ABC ABC"
    - ",abc abc."
  # Non-letter does not cancel a block in capitals
  - - "ABC%ABC"
    - ",abc%abc."

  # Number does not cancel a block in capitals
  - - "ABC123ABC"
    - ",abc#abc;abc."
    - {xfail: true} # Missing nocontract sign after number
  # capsmodechars should have no effect on begcaps and endcaps
  - - "ABC-abc"
    - ",abc-.abc"
  - - "ABC-ABC"
    - ",abc-abc."

# Original tests
flags: {testmode: backward}
tests:
  # endcaps cancels a block in capitals
  - - ",abc.abc"
    - "ABCabc"
  # Whitespace does not cancel a block in capitals
  - - ",abc abc."
    - "ABC ABC"
  # Non-letter does not cancel a block in capitals
  - - ",abc%abc."
    - "ABC%ABC"
  # Number does not cancel a block in capitals
  - - ",abc#abc;abc."
    - "ABC123ABC"
  # capsmodechars should have no effect on begcaps and endcaps
  - - ",abc-.abc"
    - "ABC-abc"
  - - ",abc-abc."
    - "ABC-ABC"

    